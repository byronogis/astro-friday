---
import type { Props as SEOProps } from 'astro-seo'
import path from 'node:path'
import { SEO } from 'astro-seo'
import { defu } from 'defu'
import config from 'virtual:astro-friday-config'
import Logo from '../assets/favicon.svg'

interface Props {
  seo?: SEOProps
}

const { seo } = Astro.props

const mergedSEO = defu<SEOProps, SEOProps[]>(
  seo || {},
  config.integrations.seo || {},
  {
    title: config.title,
    description: config.description,
    charset: 'utf-8',
    extend: {
      meta: [
        { name: 'viewport', content: 'width=device-width, initial-scale=1.0' },
      ],
      link: [
        { rel: 'icon', href: config?.logo?.url || Logo.src, type: 'image/svg+xml' },
        config.pages.rss_xml
        ? {
          rel: 'alternate',
          href: path.join(Astro.url.origin, config.astro.base, config.pages.rss_xml.pattern),
          type: 'application/rss+xml',
          title: config.title,
        }
        : {},
      ],
    },
  },
)

---

<SEO
  extend={{
    meta: [
      // ...
    ],
  }}
  {...mergedSEO}
/>
