---
import type { MarkdownHeading } from 'astro'
import type { Schema } from '../collection'
import ArticleTOCPlain from './ArticleTOCPlain.astro'

interface Props {
  headings: MarkdownHeading[]
  toc: Required<Omit<NonNullable<Schema['toc']>, 'enable'>>
}

const {
  headings,
  toc,
} = Astro.props

// <!--
//   NOTE
//   add `displaying-table-of-contents` class to any elements that can trigger the
//   TOC to show on hover
// -->

---

<details
  open
  class:list={[
    'table-of-contents prose dark:prose-invert',
    'displaying-table-of-contents',
    'text-sm my-2',
    '[&_li,&_ul]:(mt-2.5px! mb-2.5px!) [&_ul_ul]:(ps-2)',
    '[&_a]:(no-underline op-40 transition-(opacity,transform 200 ease) line-clamp-1)',
    '[&_a:hover]:(op-100)',
    'lg:(w-200px fixed z-1 left-8 top-25 bottom-0)',
    'xl:w-260px',
  ]}
>
  <summary class:list={[
      'mb-2 list-none',
      'lg:(op-30 [:root:has(.displaying-table-of-contents:hover)_&]:(op-100) transition duration-700)',
    ]}
  >
    <i class="i-lucide:list-tree hoverable-text size-6"></i>
  </summary>

  <ArticleTOCPlain
    {headings}
    {toc}
    class:list={[
      'lg:(op-0 [:root:has(.displaying-table-of-contents:hover)_&]:(op-100) transition duration-700)',
      'lg:(of-y-auto overscroll-contain max-h-70vh scrollbar-none)',
    ]}
  />
</details>
